{% extends "includes/base.html" %}
{% load content_filters static %}

{% block title %}Vote{% endblock %}

{% block extra_css %}
<link href="{% static 'css/pages/content-vote.css' %}?v=20260227a" rel="stylesheet" />
{% endblock extra_css %}

{% block content %}
<div class="container py-4 vote-page">
  <div class="card p-4 vote-card">
    <h2 class="mb-3">Vote for {{ content.title }}</h2>
    <p><strong>Artist:</strong> {{ content.artist.username }}</p>
    <p><strong>Description:</strong> {{ content.description }}</p>
    <p><strong>Average Rating:</strong> {{ average_vote|floatformat:1 }}</p>

    {% include "partials/media_display.html" with content=content %}

    {% if request.user.is_fan %}
      <form method="post" action="{% url 'vote_content' content.id %}" class="mt-4">
        {% csrf_token %}
        <label for="vote_value">Rate this content (1-5):</label>
        <select id="vote_value" name="vote_value" class="form-control vote-select">
          {% for i in "12345" %}
            <option value="{{ i }}" {% if vote_value == i %}selected{% endif %}>{{ i }}</option>
          {% endfor %}
        </select>

        <button type="submit" class="btn btn-primary mt-3">Submit Vote</button>
      </form>

      {% if vote_value %}
        <p class="mt-3">Your current vote: {{ vote_value }}</p>
      {% endif %}
    {% else %}
      <p class="mt-3">You must be logged in as a fan to vote.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
